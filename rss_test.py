import feedparser
import time

# 1. URL —Å—Ç—Ä—ñ—á–∫–∏ –Ω–æ–≤–∏–Ω (The New Stack)
rss_url = "https://thenewstack.io/feed/"

print(f"üì° –ü—ñ–¥–∫–ª—é—á–∞—é—Å—å –¥–æ: {rss_url} ...\n")

# 2. –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—ñ—á–∫–∏ (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö)
feed = feedparser.parse(rss_url)

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ
if feed.bozo:
    print("‚ö†Ô∏è  –£–≤–∞–≥–∞: –í–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ä–æ–∑–±–æ—Ä—ñ RSS (–º–æ–∂–ª–∏–≤–æ, –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–π XML), –∞–ª–µ —Å–ø—Ä–æ–±—É—î–º–æ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏.")

print(f"‚úÖ –£—Å–ø—ñ—à–Ω–æ! –ù–∞–∑–≤–∞ —Ä–µ—Å—É—Ä—Å—É: {feed.feed.title}")
print(f"üìù –í—Å—å–æ–≥–æ –∑–Ω–∞–π–¥–µ–Ω–æ –Ω–æ–≤–∏–Ω: {len(feed.entries)}\n")
print("-" * 50)

# 3. –ü—Ä–æ—Ö–æ–¥–∏–º–æ—Å—è —Ü–∏–∫–ª–æ–º –ø–æ –ø–µ—Ä—à–∏—Ö 3 –Ω–æ–≤–∏–Ω–∞—Ö
# (feed.entries - —Ü–µ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö —Å—Ç–∞—Ç–µ–π)
for entry in feed.entries[:3]:
    
    # –í–∏—Ç—è–≥—É—î–º–æ –¥–∞–Ω—ñ
    title = entry.title
    link = entry.link
    
    # –Ü–Ω–æ–¥—ñ –æ–ø–∏—Å –ª–µ–∂–∏—Ç—å –≤ 'summary', —ñ–Ω–æ–¥—ñ –≤ 'description'. Feedparser –∑–∞–∑–≤–∏—á–∞–π —Ü–µ —É–Ω—ñ—Ñ—ñ–∫—É—î –≤ 'summary'.
    # –ú–∏ –±–µ—Ä–µ–º–æ –ø–µ—Ä—à—ñ 200 —Å–∏–º–≤–æ–ª—ñ–≤ –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É
    summary_preview = entry.summary[:200] + "..." 
    
    # 4. –í–∏–≤–æ–¥–∏–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    print(f"üîπ –ó–ê–ì–û–õ–û–í–û–ö: {title}")
    print(f"üîó –õ–Ü–ù–ö: {link}")
    print(f"üìÑ –£–†–ò–í–û–ö: {summary_preview}")
    
    # –¢–£–¢ —É –º–∞–π–±—É—Ç–Ω—å–æ–º—É –±—É–¥–µ –≤–∏–∫–ª–∏–∫ OpenAI API:
    # prompt = f"–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π —Ü—é —Å—Ç–∞—Ç—Ç—é: {entry.summary}..."
    # summary = openai.chat.completion.create(...)
    
    print("-" * 50)
    time.sleep(0.5) # –ù–µ–≤–µ–ª–∏–∫–∞ –ø–∞—É–∑–∞ –¥–ª—è –∫—Ä–∞—Å–∏ –≤–∏–≤–æ–¥—É